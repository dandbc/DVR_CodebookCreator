# What is a Codebook?
A **codebook** is a reference document that lists all the OCFs in a production along with metadata such as clip name, scene, take, duration, and visual references (thumbnails). It's commonly used in professional post-production workflows to:

- Document editorial timelines for **conform**, **VFX pulls**, or **audio handoffs**
- Review footage organization during **offline and online editing**
- Facilitate communication between **editors, assistants, supervisors**, and **external vendors**
- Archive the structure and contents of a project for **future restoration or re-edits**

This script automates the generation of such a codebook directly from a **DaVinci Resolve timeline**, reducing manual work and improving accuracy.
![[Screenshot 2025-05-19 at 10.03.45.png]] 
___
# Overview: DB_Codebook_Generator_v2.2.4.py

**DB_Codebook_Generator_v2.2.4** is a custom DaVinci Resolve script that:

- Extracts timeline clip data
- Captures a still frame (thumbnail) from each clip
- Exports a fully formatted `.xlsx` spreadsheet with embedded thumbnails and metadata
- Organizes the results in a clean, self-contained folder for easy sharing or archiving
___
# Contents of this Guide
1. Requirements 🔧
2. Installation 📂
3. How to Use the Script 🧩
4. Output Structure and Metadata 📊
5. Troubleshooting 🛠️
6. Support & Contact 💬
___
## 🔧 Requirements

To use **DB_Codebook_Generator_v2.2.4**, you’ll need the following:

- **DaVinci Resolve Studio** (latest version recommended)
- **Python 3.7 or later**
- Installed Python libraries:
  - `openpyxl`
  - `pillow` (or `PIL`)

You can install the required libraries using pip:

```bash
pip install openpyxl pillow
```

___
## 📂 Installation

1. **Download the script file**  
    Ensure you have the file:  
    `DB_Codebook_Generator_v2.2.4.py`
    
2. **Locate the Resolve Scripts Directory**
    
    - **macOS**:  
        `~/Library/Application Support/Blackmagic Design/DaVinci Resolve/Fusion/Scripts/Edit`
        
    - **Windows**:  
        `C:\ProgramData\Blackmagic Design\DaVinci Resolve\Fusion\Scripts\Edit`
	1. **Copy the Script**  
    Paste the `.py` file into the `Edit` scripts folder.
    
3. **Restart DaVinci Resolve**  
    This allows Resolve to load the new script.
    

Once installed, the script will appear in Resolve under:

**Workspace > Scripts > Edit > DB_Codebook_Generator_v2.2.4**
___
## 🧩 How to Use the Script

Once the script is installed and DaVinci Resolve is open, follow these steps:

### 1. Open Your Project and Timeline

Launch **DaVinci Resolve Studio**, and open the project and timeline from which you want to generate the codebook.

### 2. Run the Script

Navigate to:

`Workspace > Scripts > Edit > DB_Codebook_Generator_v2.2.4`


>[!CAUTION]
>The script only works on the currently active timeline, so make sure the desired timeline is open and visible in the Edit page.
>
>As of version 2.2.4, the script supports only one video track at a time. If your timeline contains multiple video tracks, you can still use the script by disabling all but one track and running the script multiple times. Disabled clips will be ignored during export.

### 3. Configure Export Options

A script window will appear. You’ll be able to customize:
![[Screenshot 2025-05-19 at 9.59.42.png]]
- **Metadata Fields**: Choose which fields to include in the spreadsheet (e.g., Clip Name, Scene, Take, Reel, Audio Specs, etc.)
- **Thumbnail Frame Position**:
  - First Frame
  - Middle Frame (recommended)
  - Last Frame
- **Thumbnail Size**: Choose between small, medium, or large previews
- **Output Folder**: Select where the final `.xlsx` file and thumbnails will be saved
- **Delete Stills After Export**: Enable this to clean up Resolve’s gallery after export
>[!CAUTION]
>The **"Delete Stills After Export"** option will remove **all stills** in the current gallery, not just the ones generated by the script.
>
>To avoid losing valuable stills, we recommend **backing up your existing stills** and creating a **dedicated gallery** specifically for running this script.

> [!NOTE] 
> Thumbnails are pulled from still grabs inside the timeline and embedded directly in the Excel file.
> 
> The script automatically saves your last-used settings to:
>**macOS & Windows:** `~/Documents/ResolveCodebook/codebook_settings.json`
>
>This allows the script to preload your preferences the next time you use it — saving time on repeat exports.

### 4. Choose Export Location and File Name

After clicking **“Generate Codebook”**, the script will guide you through selecting where and how to save the output:

1. A **Finder (macOS)** or **Explorer (Windows)** window will prompt you to select the **export directory**.
2. Then, a dialog box will ask you to **name your codebook file**.
   - The default filename will be:  
     `ProjectName_TimelineName_Codebook.xlsx`
![[Screenshot 2025-05-19 at 10.00.25.png]]

> [!IMPORTANT] 
> The script will not save the files directly in the selected folder.  
> Instead, it creates a **subfolder named after the codebook filename** (without the `.xlsx` extension).  
> Both the Excel file and thumbnails will be saved inside this subfolder.

### 5. Generate the Codebook

Once the destination and filename are confirmed, the script will:

- Process all valid clips on the timeline
- Extract the selected metadata fields
- Capture a still image from the specified frame (first, middle, or last)
- Generate an `.xlsx` file with embedded thumbnails and structured metadata

✅ A confirmation message will appear once the export is successfully completed.
![[Screenshot 2025-05-19 at 10.00.45.png]]
___
## 📊 Output Structure and Metadata

After exporting, the script generates a **subfolder** inside the location you selected. Both the `.xlsx` codebook and the thumbnail images are saved together in that folder.

### 🗂 Folder Structure

`/[YourExportLocation]/DB_ProjectName_TimelineName_Editorial_Codebook/`  
`├── DB_ProjectName_TimelineName_Editorial_Codebook.xlsx`  
`├── thumbn_0.jpg`  
`├── thumbn_1.jpg`  
`├── thumbn_2.jpg`  
`└── ...`

- The subfolder is named after your **Resolve project and timeline**.
- All assets — including the `.xlsx` and **sequentially named thumbnails** (`thumbn_0.jpg`, `thumbn_1.jpg`, etc.) — are stored in the **same directory** for convenience.
![[Screenshot 2025-05-19 at 10.01.02.png]]

> [!NOTE] 
> You can safely rename or move this folder after export if needed.

---

### 🧾 Metadata Fields

The spreadsheet includes metadata for each clip based on your selection. Common fields include:

- Clip Name
- Scene / Take
- Reel / Card
- Start / End Timecode
- Resolution
- Codec
- Audio Channels
- Color Tag
- Comments

> [!TIP] 
> Fields are ordered with essential editorial metadata first (like Clip Name, Scene, and Take), followed by remaining fields sorted alphabetically.

---

### 🖼 Thumbnails

Each entry in the `.xlsx` file includes a thumbnail captured from the timeline clip:

- Choose from the **First**, **Middle**, or **Last** frame
- Thumbnails are embedded directly in the Excel file
- Thumbnail **size** is adjustable via the script UI
![[Screenshot 2025-05-19 at 10.01.26.png]]
___
## 🛠️ Troubleshooting

If something isn’t working as expected, here are some common issues and how to solve them:

### ❌ Script Doesn’t Appear in Resolve

- Make sure the script file `DB_Codebook_Generator_v2.2.4.py` is located in the correct directory:

  - **macOS**:  
    `~/Library/Application Support/Blackmagic Design/DaVinci Resolve/Fusion/Scripts/Edit`

  - **Windows**:  
    `C:\ProgramData\Blackmagic Design\DaVinci Resolve\Fusion\Scripts\Edit`

- Ensure that the `Edit` page is active in Resolve.
- Restart DaVinci Resolve after copying the script.

### ❌ Script Fails to Start or Crashes Immediately

- The script depends on the **DaVinci Resolve Script Module** (usually named `DaVinciResolveScript.py`).
- If this module is **not found in the expected directory**, the script will not run and may silently fail.

#### ✅ How to fix it:

1. Locate the official script module file:
   - Usually found in Resolve's installation directory or SDK package.
2. Copy `DaVinciResolveScript.py` into the **same folder** as the `DB_Codebook_Generator_v2.2.4.py` script.
3. Restart Resolve and try again.

> [!TIP]
>  You can also open the **DaVinci Resolve Console** (from the Workspace > Console menu) to check for missing import errors or other crash messages.
### ❌ Excel File Is Empty or Missing Data

- Confirm that a **timeline is open and active** in the Edit page.
- The script only works with **visible and enabled video clips** on a **single video track**.
- Disable all other video tracks and run the script again.

### ❌ Thumbnails Are Missing

- Verify that:
  - The clips are online (not offline media).
  - You're not using titles, generators, or Fusion compositions.
  - Still frames are being generated correctly inside Resolve.

### ⚠️ “Delete Stills After Export” Removed More Than Expected

- This option deletes **all stills** from the active gallery — not just those generated by the script.
- To prevent data loss:
  - **Back up important stills**
  - Use a **dedicated stills gallery** during export

### 🐍 Python Errors or Script Crashes

- Make sure Python 3.7 or newer is installed on your system.
- Install the required libraries using:

  ```bash
  pip install openpyxl pillow
  ```
- Check the Resolve **Console** and **Log Folder** for additional debugging info:
	- **Help > Reveal Log Folder**

>[!NOTE]
> If you're still having issues, share the console output or log and contact support for help.

___
## 💬 Support & Feedback

Have questions, found a bug, or want to suggest a feature?

I'm actively maintaining this script and appreciate any feedback from editors, assistants, post supervisors, and anyone using it in real workflows.

### 📨 Contact

- **Email:** dany.b@dandbc.mx
- **GitHub:** [github.com/dandbc](https://github.com/dandbc)
- **Buy Me a Coffee:** [buymeacoffee.com/dandbc](https://www.buymeacoffee.com/dandbc)

> ☕ If this tool saved you time or helped your project, consider supporting future development with a coffee!

---
### 🙌 Contribute

If you'd like to contribute:

- Fork the repo on GitHub
- Submit pull requests or open issues
- Share the tool with others in your post-production network

Let’s make the boring parts of post a little less boring — together.
